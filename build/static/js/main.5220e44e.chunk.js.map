{"version":3,"sources":["img/photo_other.jpg","img/photo.jpg","data/store.js","data/reducers/signUpReducer.js","data/reducers/loginReducer.js","data/reducers/session.js","data/reducers/message.js","history/history.js","sdk/init.js","utils/token.js","decorators/seferender.js","component/common/tooltip/index.js","component/sign/SignBasic.js","component/sign/Login.js","data/actions/loginAction.js","data/actions/actionCreator.js","data/actions/signUpAction.js","component/sign/Signup.js","component/chat/sliderBar/index.js","data/actions/session.js","utils/event.js","data/actions/message.js","component/common/dialog/index.js","component/chat/bubblePanel/index.js","component/common/icon/index.js","component/chat/sessionList/index.js","component/chat/index.js","App.js","registerServiceWorker.js","index.js"],"names":["module","exports","__webpack_require__","p","reducers","combineReducers","signUp","initState","arguments","length","undefined","status","action","type","Object","assign","payload","login","currentSession","session","allFriend","toConsumableArray","message","to","msgList","currentMsg","msg","list","push","addTextMsg","middlewares","thunk","store","applyMiddleware","apply","createStore","history","createHashHistory","conn","WebIM","connection","isMultiLoginSessions","config","https","url","xmppURL","heartBeatWait","autoReconnectNumMax","autoReconnectInterval","apiUrl","apiURL","isHttpDNS","isWindowSDK","isAutoLogin","encrypt","delivery","token","getToken","d","SignBasic","active","errorHandler","e","alert","displayName","method","target","forEach","blankFn","unsafe","prototype","report","console","log","call","this","name","stack","state","props","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","hint","header","button","account","footer","aLink","showNickName","userName","password","nickName","_this2","setState","changeInput","event","value","trim","handleSubmit","ev","preventDefault","handleSignUp","handleLogin","react_default","a","createElement","className","Link","placeholder","onChange","onClick","Component","Tooltip","_this$props","content","concat","defaultProps","time","timer","close","ReactDOM","unmountComponentAtNode","parentNode","removeChild","tooltip","show","document","body","appendChild","render","tooltip_Tooltip","clearTimeout","setTimeout","Login","connect","loginToServer","options","dispatch","getState","Promise","resolve","reject","success","error","err","sdk","open","data","user","pwd","appKey","appkey","then","sign_SignBasic","actionCreator","_len","key","Array","_key","_len2","_key2","item","index","signUpAction","SignUp","signUpToServer","onSuccess","onError","registerUser","username","toLowerCase","nickname","SlideBar","tokenUser","src","require","alt","currentSessionActon","fetchAllFriendAction","fetchAllFriend","getRoster","response","myFriends","filter","subscription","utils_event","EventEmitter","addTextMsgAaction","addTextMsgAndChangeFriendList","who","from","newAllFriend","map","newItem","objectSpread","newMsg","container","chat_bubblePanel","chatType","id","getUniqueId","set","roomType","serverMsgId","fromMe","fail","send","BubblePanel","aloneMessage","handleUserInput","sendMessage","_this2$props","getAloneMessage","_this2$props2","mainRef","scrollTop","scrollHeight","_this3","ref","bubblePanel_MessageItemErrorWrapper","cols","rows","MessageItemErrorWrapper","_this4","hasError","info","bubblePanel_MessageItem","MessageItem","mi_item","classnames","you","me","Icon","classNames","defineProperty","iconfont","Dialog","closeDialog","onClose","title","showMask","icon","common_dialog","dialog_Dialog","SessionList","eventEmitter","on","dialog","bind","accept","subscribed","subscribe","unsubscribed","showAddFriend","nickNameRef","confirmAddFriend","removeListener","handlePresence","chatId","isSelected","sessionList_SessionItem","friend","SessionItem","itemClick","nextProps","nextState","shallowequal","pathname","friendName","Chat","init","listen","onOpened","onTextMessage","onRoster","onPresence","emit","_Object$assign","location","chat_sliderBar","chat_sessionList","window","Home","App","es","HashRouter","Route","path","component","Signup","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","catch","App_App","getElementById","URL","process","origin","addEventListener","fetch","headers","get","indexOf","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.5220e44e.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/photo_other.1969756e.jpg\";","module.exports = __webpack_public_path__ + \"static/media/photo.1fa99390.jpg\";","import { createStore, combineReducers, applyMiddleware} from 'redux'\r\nimport thunk from 'redux-thunk';\r\nimport { signUpReducer } from './reducers/signUpReducer' \r\nimport { loginReducer } from './reducers/loginReducer'\r\nimport { currentSessionReducer } from './reducers/session'\r\nimport { messageReducer } from './reducers/message'\r\n\r\nconst reducers = combineReducers({\r\n    signUp: signUpReducer,\r\n    login: loginReducer,\r\n    currentSession: currentSessionReducer,\r\n    message: messageReducer\r\n})\r\nconst middlewares = [thunk]\r\nconst store = applyMiddleware(...middlewares)(createStore)(reducers)\r\n\r\nexport default store\r\n\r\n","// 初始：0， 进行中：1， 成功：2，  失败：3\r\n\r\nconst signUpReducer = (initState={status: 0}, action)=>{\r\n    switch(action.type){\r\n        case 'SIGNUP':\r\n            return Object.assign({}, initState, {status: action.payload.status})\r\n        default:\r\n            return initState\r\n    }\r\n}\r\nexport { signUpReducer }","// 初始：0， 进行中：1， 成功：2，  失败：3\r\n\r\nconst loginReducer = (initState={status: 0}, action)=>{\r\n    switch(action.type){\r\n        case 'LOGIN':\r\n            return Object.assign({}, initState, {status: action.payload.status})\r\n        default:\r\n            return initState\r\n    }\r\n}\r\nexport { loginReducer }","function currentSessionReducer(initState={\r\n    session: null,\r\n    allFriend: []\r\n}, action){\r\n    switch(action.type){\r\n        case 'CURRENT_SESSION':\r\n            return Object.assign({}, initState, {session: action.payload.session})\r\n        case 'FETCH_ALL_FRIEND':\r\n            return Object.assign({}, initState, {allFriend: [...action.payload.allFriend]})\r\n        default:\r\n            return initState\r\n    }\r\n}\r\n\r\nexport { currentSessionReducer }","// msgList = { 'zhang': [], 'wang': []}\r\n\r\nfunction messageReducer(initState={\r\n    msgList: {},\r\n    currentMsg: []\r\n}, action){\r\n    switch(action.type){\r\n        case 'ADD_TEXT_MSG':            \r\n            return Object.assign({}, initState, {msgList: addTextMsg(action.payload.to, action.payload.message, initState.msgList)})\r\n        case 'GET_ALONE_MSG':\r\n            return Object.assign({}, initState, {currentMsg: filterMsgList(action.payload.to, initState.msgList)})\r\n        default:\r\n            return initState\r\n    }\r\n}\r\n\r\nexport { messageReducer }\r\n\r\n\r\nfunction filterMsgList(to, msgList){\r\n    return msgList[to] ? [...msgList[to] ] : []\r\n}\r\n\r\nfunction addTextMsg(to, msg, msgList){\r\n    let list = msgList[to] || []\r\n    list.push(msg)\r\n    msgList[to] = list\r\n    return Object.assign({}, msgList)   //想要触发bubblePanel组件渲染，此处必须生成新的地址，原因未知\r\n}","import createHashHistory from 'history/createHashHistory';\r\nconst history = createHashHistory()\r\nexport default history","let conn = new WebIM.connection({\n    isMultiLoginSessions: WebIM.config.isMultiLoginSessions,\n    https: false,\n    url: WebIM.config.xmppURL,\n    heartBeatWait: WebIM.config.heartBeatWait,\n    autoReconnectNumMax: WebIM.config.autoReconnectNumMax,\n    autoReconnectInterval: WebIM.config.autoReconnectInterval,\n    apiUrl: WebIM.config.apiURL,\n    isHttpDNS: WebIM.config.isHttpDNS,\n    isWindowSDK: WebIM.config.isWindowSDK,\n    isAutoLogin: true,\n    encrypt: WebIM.config.encrypt,\n    delivery: WebIM.config.delivery\n});\n\nexport default conn","let token = null\r\nconst getToken = ()=>{\r\n    return token\r\n}\r\nconst setToken = (newToken)=>{\r\n    return token = newToken\r\n}\r\nexport {getToken, setToken}\r\n\r\n\r\n// !function xx(){\r\n//     let token = 100\r\n//     return {\r\n//         get: ()=>{},\r\n//         set: ()=>{}\r\n//     }\r\n// }()","export default function safeRender(config){\r\n    return function(target){ \r\n        if(config.active){\r\n            [\r\n                'render',\r\n                'componentWillMount',\r\n                'componentDidMount',\r\n                'componentWillReceiveProps',\r\n                'componentWillUpdate',\r\n                'componentDidUpdate',\r\n                'compoentnWillUnmount',\r\n                'shouldComponentUpdate'\r\n            ].forEach((method)=>{\r\n                let blankFn =  method === 'shouldComponentUpdate' ? ()=>{return true} : ()=>{return null}\r\n                let unsafe = target.prototype[method] || blankFn    // 原来的方法  \r\n                config.errorHandler = config.errorHandler || function(report){\r\n                    console.log(report)\r\n                }             \r\n\r\n                target.prototype[method] = function(){              // 修改原方法\r\n                    try{\r\n                        return unsafe.call(this, arguments)\r\n                    }catch(e){\r\n                        let report = {\r\n                            displayName: target.name,   // 组件名\r\n                            method: method,             // 方法名\r\n                            message: e.stack,           // 出了什么问题？\r\n                            state: this.state,\r\n                            props: this.props\r\n                        }\r\n                        config.errorHandler(report)\r\n                        return blankFn.call(this, arguments)    // shouldComponentUpdate 和 render 函数在报错的时候也应该有返回值\r\n                    }\r\n                }\r\n            })\r\n        }\r\n    \r\n    }\r\n}","import React, { Component } from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport './index.css'\r\n// tooltip样式 48分钟\r\nclass Tooltip extends Component{\r\n    static defaultProps = {\r\n        time: 3000,         //3s自动消失\r\n        type: 'success',    //默认成功的样式\r\n        content: ''         // 显示的内容\r\n    }\r\n    render(){\r\n        // 视频2 36分钟 添加类\r\n        let {type, content} = this.props\r\n        return (\r\n            <div className=\"tooltips\">\r\n                <div>{`${type}: ${content}`}</div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\n\r\nlet d\r\nlet timer = null\r\nfunction show(props){\r\n    if(d){\r\n        close()\r\n    }\r\n    d = document.createElement('div')\r\n    document.body.appendChild(d)\r\n    ReactDOM.render(<Tooltip {...props} />, d)\r\n\r\n    timer && clearTimeout(timer)\r\n    timer = setTimeout(() => {\r\n        close()\r\n    }, props.time || 3000);\r\n}\r\nfunction close(){\r\n    if(d){\r\n        ReactDOM.unmountComponentAtNode(d)\r\n        d.parentNode.removeChild(d)\r\n        d = null\r\n    }\r\n}\r\n\r\nconst tooltip = {show, close}\r\n\r\nexport default tooltip","import React, { Component } from 'react'\r\nimport { Link } from 'react-router-dom' \r\nimport safeRender from '../../decorators/seferender'\r\nimport './signBasic.css'\r\n\r\n@safeRender({\r\n    active: true,\r\n    errorHandler: function(e){\r\n        alert(e.displayName + \"----\" + e.method)\r\n    }\r\n})\r\n\r\n\r\nclass SignBasic extends Component{\r\n    constructor(props){\r\n        super(props)\r\n        this.state = {\r\n            hint: {\r\n                header: '',\r\n                button: '',\r\n                account: '',\r\n                footer: '',\r\n                aLink: '',\r\n                showNickName: false\r\n            },\r\n            userName: '',\r\n            password: '',\r\n            nickName: ''\r\n        }\r\n    }\r\n    componentWillMount(){\r\n        this.props.hint===\"signUp\" ? \r\n        this.setState({ hint: {header: '注册', button: '注册', account: '已有账户', footer: '立即登录', aLink: '/login',  showNickName: true } }) :             \r\n        this.setState({ hint: {header: '登录', button: '登录', account: '没有账户', footer: '立即注册', aLink: '/signUp', showNickName: false} })\r\n\r\n        this.changeInput = (event)=>{\r\n            switch(event.target.name){\r\n                case 'userName':\r\n                    return  this.setState({userName: event.target.value})\r\n                case 'password':\r\n                    return  this.setState({password: event.target.value.trim()})\r\n                case 'nickName':\r\n                    return  this.setState({nickName: event.target.value})\r\n                default:\r\n                    return \r\n            }\r\n        }\r\n\r\n        this.handleSubmit = (ev)=>{\r\n            ev.preventDefault()\r\n            this.props.hint===\"signUp\" ? \r\n            this.props.handleSignUp(this.state) : \r\n            this.props.handleLogin(this.state)\r\n        }\r\n    } \r\n    render(){\r\n        return (\r\n            <div className=\"signBasic\">\r\n                <header>\r\n                    <div className='header_inner'>\r\n                        <h1 className='logo'>张治国 聊天小作品</h1>\r\n                        <div className='signUpBtn'>\r\n                            <Link to={this.state.hint.aLink}>{this.state.hint.footer}</Link>\r\n                        </div>\r\n                    </div>\r\n                </header>\r\n                <main>\r\n                    <div className='main_inner'>\r\n                        <form>\r\n                            <h3>{this.state.hint.header}</h3>\r\n                            <div className='row'>\r\n                                <i className=\"iconfont icon-photo\"></i>\r\n                                <input type=\"text\" name=\"userName\" placeholder=\"用户名\" className=\"input firstInput\"\r\n                                    value={this.state.userName} \r\n                                    onChange={this.changeInput}\r\n                                />\r\n                            </div>\r\n                            <div className='row'>\r\n                                <i className=\"iconfont icon-clock\"></i>\r\n                                <input type=\"password\" name=\"password\" placeholder=\"密码\" className=\"input\"\r\n                                    value={this.state.password} \r\n                                    onChange={this.changeInput}\r\n                                />\r\n                            </div>\r\n\r\n                            {this.state.hint.showNickName ? \r\n                                <div className='row'>\r\n                                    <i className=\"iconfont icon-photo\"></i>\r\n                                    <input type=\"text\" name=\"nickName\" placeholder=\"输入昵称\" className=\"input\"\r\n                                        value={this.state.nickName} \r\n                                        onChange={this.changeInput}\r\n                                    /> \r\n                                </div>\r\n                            : null}\r\n                                \r\n                            <div className='button_wrapper'>\r\n                                <input type=\"submit\" name=\"submit\" className=\"button\"\r\n                                    value={this.state.hint.button}\r\n                                    onClick={this.handleSubmit}\r\n                                />\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </main>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\nexport default SignBasic","import React, { Component } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { loginToServer} from '../../data/actions/loginAction'\r\nimport SignBasic from './SignBasic'\r\nimport tooltip from '../../component/common/tooltip/index'\r\nimport history from '../../history/history'\r\nimport {setToken} from '../../utils/token'\r\n\r\n@connect(\r\n    (state)=>{return {status: state.login.status}},\r\n    {loginToServer: loginToServer}\r\n)\r\nclass Login extends Component{\r\n    componentWillMount(){\r\n        this.handleLogin = (data)=>{\r\n            if(!data.userName || !data.password){\r\n                tooltip.show({\r\n                    type: 'error',\r\n                    content: '账号密码不能为空'\r\n                })\r\n                return \r\n            }\r\n            let options = { \r\n                user: data.userName.trim(),\r\n                pwd: data.password,\r\n                appKey: WebIM.config.appkey,\r\n                apiUrl: WebIM.config.apiURL,\r\n            }\r\n            \r\n            this.props.loginToServer(options).then(\r\n                (token)=>{\r\n                    setToken(token)                 // 登录成功后要把token记录下来\r\n                    history.push('/chat')\r\n                },\r\n                (err)=>{\r\n                    tooltip.show({\r\n                        type: 'error',\r\n                        content: '登录失败了'\r\n                    })\r\n                }\r\n            )\r\n        }\r\n    }\r\n    render(){\r\n        return (\r\n            <SignBasic hint=\"login\" handleLogin={this.handleLogin} status={this.props.status}/>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Login ","// 收集用户输入的数据\r\n// 指定响应成功和失败时执行的函数\r\n// 和服务器建立联系\r\n// 成功时自动执行成功函数，失败时自动执行失败函数\r\n\r\n// 这里成功函数和失败函数，分别是在调用loginToServer时再then里指定的，做到了不一样的情景执行不一样的任务\r\n\r\nconst loginToServer = (options)=>{\r\n    return (dispatch, getState)=>{\r\n        return new Promise((resolve, reject)=>{\r\n            options.success = (token)=>{\r\n                resolve(token)\r\n            }\r\n            options.error = (err)=>{ \r\n                reject(err)\r\n            }\r\n            sdk.conn.open(options) \r\n        })\r\n    }\r\n}\r\n\r\nexport { loginToServer }","// key = ['name', 'age', 'sex']\r\n// value = ['zhang', 18, 'nan']\r\nconst actionCreator = (type, ...key)=>{\r\n    return (...value)=>{\r\n        let action = { type: type, payload: {} }\r\n        key.forEach((item, index)=>{\r\n            action.payload[key[index]] = value[index]\r\n        })\r\n        return action\r\n    }\r\n}\r\n\r\nexport default actionCreator\r\n","\r\nimport actionCreator  from './actionCreator'\r\nconst signUpAction = actionCreator('SIGNUP', 'status') \r\n\r\n\r\n// 收集用户输入的数据\r\n// 指定响应成功和失败时执行的函数\r\n// 和服务器建立联系\r\n// 成功时自动执行成功函数，失败时自动执行失败函数\r\n// 这里成功函数和失败函数，分别是在调用signUpToServer时在then里指定的，做到了不一样的情景执行不一样的任务\r\n\r\n\r\nconst signUpToServer = (options)=>{\r\n    return (dispatch, getState)=>{\r\n        return new Promise((resolve, reject)=>{\r\n            // options对象里应该定义响应成功和失败的函数，但是被我定义在了then里面\r\n            let onSuccess = options.success\r\n            let onError = options.error\r\n            options.success = ()=>{\r\n                dispatch(signUpAction(2))   //修改store中的注册状态为成功2\r\n                onSuccess && onSuccess()    //此处不执行\r\n                resolve()                   //注册成功时执行该函数，在then中被指定\r\n            }\r\n            options.error = ()=>{\r\n                dispatch(signUpAction(3))\r\n                onError && onError()    \r\n                reject()\r\n            }\r\n            sdk.conn.registerUser(options) \r\n        })\r\n    }\r\n}\r\nexport { signUpToServer }","import React, { Component } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { signUpToServer} from '../../data/actions/signUpAction'\r\nimport SignBasic from './SignBasic'\r\nimport tooltip from '../../component/common/tooltip/index'\r\nimport history from '../../history/history'\r\n\r\n\r\n@connect(\r\n    (state)=>{return {status: state.signUp.status}},\r\n    {signUpToServer: signUpToServer}\r\n)\r\nclass SignUp extends Component{\r\n    componentWillMount(){\r\n        // handleSignUp做三件事：收集用户输入、和服务器建立联系、指定成功任务和失败任务\r\n        this.handleSignUp = (data)=>{\r\n            if(!data.userName || !data.password || !data.nickName){\r\n                tooltip.show({\r\n                    type: 'error',\r\n                    content: '账号密码不能为空'\r\n                })\r\n                return \r\n            }\r\n            let options = { \r\n                username: data.userName.trim().toLowerCase(),\r\n                password: data.password,\r\n                nickname: data.nickName,\r\n                appKey: WebIM.config.appkey,\r\n                apiUrl: WebIM.config.apiURL,\r\n            }\r\n            this.props.signUpToServer(options).then(\r\n                ()=>{\r\n                    history.push('/login')          //注册成功时跳转到登录页面，让用户输入用户名和密码后即可正常使用\r\n                },\r\n                ()=>{\r\n                    tooltip.show({                  //注册失败时，给出一个提示\r\n                        content: '注册失败了',\r\n                        type: 'error'\r\n                    })\r\n                }\r\n            )\r\n        }\r\n    }\r\n    render(){\r\n        return (\r\n            <SignBasic hint=\"signUp\" handleSignUp={this.handleSignUp} status={this.props.status}/>\r\n        )\r\n    }\r\n}\r\n\r\nexport default SignUp ","import React, { Component } from 'react'\r\nimport {getToken} from '../../../utils/token'\r\nimport './index.css'\r\n\r\nclass SlideBar extends Component{\r\n    render(){\r\n        let tokenUser = getToken()\r\n        let username = tokenUser ? tokenUser.user.username : ''\r\n        return (\r\n            <div className=\"sb\">\r\n                <div className='sb_header'>\r\n                    <div className=\"photo_wrapper avator\">\r\n                        <img src={require('../../../img/photo.jpg')} alt=\"\"/>\r\n                    </div>\r\n                    <p className='myNickName'>{username}</p>\r\n                </div>\r\n                <div className='sb_main'>\r\n                    <div className=\"icon_wrapper chat\">\r\n                        <i className=\"iconfont icon-chat\"></i>\r\n                    </div>\r\n                </div>\r\n                <div className='sb_footer'>\r\n                    <dir className=\"icon_wrapper setting\">\r\n                        <i className=\"iconfont icon-shezhi\"></i>\r\n                    </dir>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default SlideBar","import actionCreator  from './actionCreator'\r\n\r\nconst currentSessionActon = actionCreator('CURRENT_SESSION', 'session')\r\n\r\nconst fetchAllFriendAction = actionCreator('FETCH_ALL_FRIEND', 'allFriend')\r\n\r\n\r\nfunction fetchAllFriend(){           // 找到互为好友的人\r\n    return (dispatch, getState)=>{\r\n        return new Promise((resolve, reject)=>{\r\n            sdk.conn.getRoster({\r\n                success: (response)=>{     \r\n                    let myFriends = response.filter((item)=>{\r\n                        return item.subscription === 'both'\r\n                    })\r\n                    dispatch(fetchAllFriendAction(myFriends))\r\n                    resolve()\r\n                },\r\n                error: (err)=>{\r\n                    reject()\r\n                }\r\n            })\r\n        })\r\n    }\r\n}\r\n\r\n// 来到消息就执行该函数\r\n// 接收到一条消息，可能是我发送的，也可能是好友发送的\r\n// 遍历好友数组，假设消息的发送者是好友AAA，就给它添加newMsg属性，属性值就是他发送的那一条消息\r\n// 在好友列表那个组件里，判断是否有newMsg属性，有的话就当做预览展示出来\r\nfunction changeFriendListWithMsg(msg){\r\n    return (dispatch, getState)=>{\r\n        let name = msg.from   // 消息的发送者\r\n        let allFriend = getState().currentSession.allFriend     //所有好友\r\n        let newAllFriend = allFriend.map((item)=>{      // 新的好友列表\r\n            let newItem = {...item}\r\n            if(newItem.name === name){\r\n                newItem.newMsg = msg\r\n            }\r\n            return newItem\r\n        })\r\n        dispatch(fetchAllFriendAction(newAllFriend))\r\n    }\r\n}\r\n\r\nexport { fetchAllFriend, currentSessionActon, changeFriendListWithMsg }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// const signUpAction = actionCreator('SIGNUP', 'status') \r\n\r\n// const signUpToServer = (options)=>{\r\n//     return (dispatch, getState)=>{\r\n//         return new Promise((resolve, reject)=>{\r\n//             let onSuccess = options.success\r\n//             let onError = options.error\r\n//             options.success = ()=>{\r\n//                 dispatch(signUpAction(2))\r\n//                 onSuccess && onSuccess() \r\n//                 resolve()\r\n//             }\r\n//             options.error = ()=>{\r\n//                 dispatch(signUpAction(3))\r\n//                 onError && onError()    \r\n//                 reject()\r\n//             }\r\n//             sdk.conn.registerUser(options) \r\n//         })\r\n//     }\r\n// }\r\n// export { signUpToServer }","import EventEmitter from 'eventemitter3'\r\n\r\nexport default new EventEmitter()","import actionCreator  from './actionCreator'\r\nimport {getToken} from '../../utils/token'\r\nimport {fetchAllFriend, changeFriendListWithMsg} from './session'\r\nimport eventEmitter from '../../utils/event'\r\n\r\nconst addTextMsgAaction = actionCreator('ADD_TEXT_MSG', 'to', 'message')\r\n\r\n// const getAloneMsgAaction = actionCreator('GET_ALONE_MSG', 'message')\r\n\r\nfunction addTextMsgAndChangeFriendList(who, message){\r\n    return (dispatch, getState)=>{\r\n        dispatch(addTextMsgAaction(who, message))\r\n        changeFriendListWithMsg(message)(dispatch, getState)\r\n    }\r\n}\r\n\r\nfunction init(){\r\n    return (dispatch, getState)=>{\r\n        sdk.conn.listen({   \r\n            onOpened: ()=>{     //链接成功立即执行的回调函数\r\n                dispatch(fetchAllFriend())\r\n            },\r\n            onTextMessage: (message)=>{\r\n                message.value = message.value || message.data   // 做个兼容\r\n                addTextMsgAndChangeFriendList(message.from, message)(dispatch, getState)\r\n            },\r\n            onRoster: ()=>{     // 别人处理完我发送的关于“好友请求”的信息，执行此函数\r\n                dispatch(fetchAllFriend())\r\n            },\r\n            onPresence: (message)=>{   // 别人发来的关于“好友请求”的信息，执行此函数\r\n                eventEmitter.emit('presence', message)\r\n            }\r\n        }) \r\n    }\r\n}\r\n\r\n/* \r\n*   任务一：发送文本消息到服务器（此处服务器接收消息和好友接收消息是有区别的）\r\n*   任务二：保存此条消息到store\r\n*/\r\nfunction addTextMsg(to, message, chatType){\r\n    return (dispatch, getState)=>{\r\n        let name = getToken().user.nickname\r\n        let id = sdk.conn.getUniqueId();              \r\n        let msg = new WebIM.message('txt', id)\r\n        msg.set({\r\n            msg: message,                 \r\n            to: to,               \r\n            roomType: false,\r\n            success:(id, serverMsgId)=>{ \r\n                msg.fromMe = true   // 用来区分信息是发送还是接收\r\n                msg.from = name    // from：我的名字\r\n                addTextMsgAndChangeFriendList(to, msg)(dispatch, getState)\r\n            },\r\n            fail: (e)=>{\r\n                alert('消息到服务器失败')\r\n            }\r\n        });\r\n        msg.body.chatType = chatType\r\n        sdk.conn.send(msg.body);\r\n    }\r\n}\r\n\r\n/* 获取to的聊天消息 */\r\nfunction getAloneMsg(){}\r\n\r\n/* 改变消息状态，页面动态更新气泡提示：如对方看到后显示已经看过，没看过时下方显示消息未读 */\r\nfunction changeMsgStatus(){}\r\n\r\n\r\nexport {init, addTextMsg, getAloneMsg, changeMsgStatus}\r\n","import React, { Component } from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport Icon from '../icon/index'\r\nimport './index.css'\r\n\r\nclass Dialog extends Component{\r\n    static defaultProps = {\r\n      showMask: true\r\n    }\r\n    componentWillMount(){\r\n        this.closeDialog = ()=>{\r\n            close()\r\n            this.props.onClose && this.props.onClose()    //执行callback，前提是存在 \r\n        }\r\n    }\r\n\r\n    render(){\r\n        let {title, content, footer, showMask} = this.props       \r\n        return (\r\n            <div className='dlg_wrapper'>\r\n                {showMask ? \r\n                    <div className='dlg_mask' /> : \r\n                null}\r\n                <div className='dlg'>\r\n                    <div className='dlg_closeBtn' onClick={this.closeDialog}>\r\n                        <Icon type='guanbi' />\r\n                    </div>\r\n                    <div className='dlg_header'>{title}</div>\r\n                    <div className='dlg_main'>{content}</div>\r\n                    <div className='dlg_footer'>{footer}</div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\nlet container\r\nfunction show(props){\r\n    container && close()\r\n    if(container){\r\n        close()\r\n    }\r\n    container = document.createElement('div')\r\n    document.body.appendChild(container)\r\n    ReactDOM.render(<Dialog {...props}/>, container)\r\n}\r\n\r\nfunction close(){\r\n    if(container){\r\n        ReactDOM.unmountComponentAtNode(container)\r\n        container.parentNode.removeChild(container)\r\n        container = null\r\n    }\r\n}\r\n\r\n\r\nexport default {show, close}\r\n","import React, { Component } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport classnames from 'classnames'\r\nimport {addTextMsg} from '../../../data/actions/message'\r\nimport './index.css'\r\n\r\n@connect(\r\n    (state)=>{return {\r\n        session: state.currentSession.session,      // sessionList组件中我选择的好友（我点击的Link）\r\n        msgList: state.message.msgList              // 所有好友所有信息\r\n    }},\r\n    {addTextMsg}\r\n)\r\nclass BubblePanel extends Component{\r\n    constructor(props){\r\n        super(props)\r\n        this.state = {\r\n            message: '',\r\n            aloneMessage: ''\r\n        }\r\n    }\r\n    componentWillMount(){\r\n        this.handleUserInput = (ev)=>{\r\n            this.setState({message: ev.target.value})\r\n        }\r\n        this.sendMessage = ()=>{\r\n            let {addTextMsg, session, chatType} = this.props\r\n            let {message} = this.state\r\n            this.setState({\r\n                message: ''\r\n            })\r\n            session && this.state.message.trim()!=='' && addTextMsg(session.name, message, chatType)\r\n        }\r\n        this.getAloneMessage = ()=>{\r\n            let {msgList, session} = this.props\r\n            // if(!session){\r\n            //     return []\r\n            // }\r\n            let xx = session!==null ? session.name : ''\r\n            return msgList[xx] || []\r\n        }\r\n    }\r\n    componentDidUpdate(){\r\n        this.mainRef.scrollTop = this.mainRef.scrollHeight\r\n    }\r\n    render(){\r\n        let {session} = this.props\r\n        let aloneMessage = this.getAloneMessage()\r\n        return (\r\n            <div className='bp'>\r\n                <div className=\"bp_header\">\r\n                    {session ? session.name : ''}\r\n                </div>\r\n                <div className=\"bp_main\" ref={(content)=>{this.mainRef = content}}>\r\n                    <div className=\"timeHint\"></div>\r\n                    {\r\n                        aloneMessage.map((item)=>{\r\n                            return <MessageItemErrorWrapper key={item.id} msg={item} />\r\n                        })\r\n                    }\r\n                </div>\r\n                <div className=\"bp_footer\">\r\n                    <textarea name=\"\" id=\"\" cols=\"30\" rows=\"10\" placeholder='输入消息' className='textArea' \r\n                        value={this.state.message}\r\n                        onChange={this.handleUserInput} \r\n                    />\r\n                    <div className='sendButton' onClick={this.sendMessage}>发送</div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default BubblePanel\r\n\r\n\r\nclass MessageItemErrorWrapper extends Component{\r\n    constructor(props){\r\n        super(props)\r\n        this.state = {\r\n            hasError: false\r\n        }\r\n    }\r\n    componentDidCatch(err, info){\r\n        this.setState({\r\n            hasError: true\r\n        })\r\n    }\r\n    render(){\r\n        if(this.state.hasError){\r\n            return <div>出错了，请联系RD修复</div>\r\n        }\r\n        return <MessageItem msg={this.props.msg} />\r\n    }\r\n}\r\n\r\n\r\nclass MessageItem extends Component{\r\n    render(){\r\n        let {msg} = this.props\r\n        // 如何区分收到的还是发出的？在发出的对象上添加fromMe属性，有该属性就是我发出，没有该属性就是我收到\r\n        let fromMe = msg.fromMe ? true : false  \r\n        let mi_item = classnames({\r\n            'mi_item': true,\r\n            'you': !fromMe,\r\n            'me': fromMe\r\n        })      \r\n        return (\r\n            <div className={mi_item}>\r\n                <figure className='mi_photo'>\r\n                    <img src={require('../../../img/photo_other.jpg')} alt=\"头像\"/>\r\n                </figure>\r\n                <div className='mi_text'>\r\n                    \r\n                    {msg.value}\r\n                    <div className='san'></div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}","import React, { Component } from 'react'\r\nimport classnames from 'classnames'\r\n\r\nclass Icon extends Component{\r\n    render(){\r\n        let {type} = this.props\r\n        let classNames = classnames({\r\n            'iconfont': true,\r\n            ['icon-' + type]: true\r\n        })\r\n        \r\n        return <span className={classNames}></span>\r\n    }\r\n}\r\n\r\nexport default Icon","import React, { Component } from 'react'\r\nimport dialog from '../../common/dialog/index'\r\nimport { Link } from 'react-router-dom' \r\nimport {connect} from 'react-redux'\r\nimport {currentSessionActon} from '../../../data/actions/session'\r\nimport eventEmitter from '../../../utils/event'\r\nimport shallowequal from 'shallowequal'\r\nimport './index.css'\r\n\r\n@connect(\r\n    (state)=>{return {allFriend: state.currentSession.allFriend}}\r\n)\r\nclass SessionList extends Component{\r\n\r\n    componentWillMount(){    \r\n        // 别人加我为好友时，弹出框 \r\n        eventEmitter.on('presence', (message)=>{\r\n            if (message.type === 'subscribe') {\r\n                dialog.show({\r\n                    title: '添加好友',\r\n                    content: <div className='sl_dlg_header_inner'>\r\n                                <p className='who'>{message.from}邀请加你为好友</p>\r\n                                <p className='message'>留言：{message.status}</p>\r\n                            </div>,\r\n                    footer: <div className='sl_dlg_footer_inner'>\r\n                                <button className='reject' onClick={this.reject.bind(this, message)}>拒绝</button>\r\n                                <button className='accept' onClick={this.accept.bind(this, message)}>同意</button>\r\n                            </div>\r\n                })\r\n            } \r\n        })\r\n        this.accept = (message)=>{\r\n            sdk.conn.subscribed({     \r\n                to: message.from,\r\n                message : '[resp:true]'\r\n            });\r\n            sdk.conn.subscribe({        //需要反向添加对方好友\r\n                to: message.from,\r\n                message : '[resp:true]'\r\n            });\r\n            dialog.close()\r\n        }\r\n        this.reject = (message)=>{\r\n            sdk.conn.unsubscribed({\r\n                to: message.from,\r\n                message : 'rejectAddFriend'\r\n            })\r\n            dialog.close()\r\n        }\r\n\r\n\r\n        // 我加别人为好友时，弹出框\r\n        this.showAddFriend = ()=>{\r\n            dialog.show({\r\n                title: '添加好友',\r\n                content: <div className='sb_dlg_header_inner'>\r\n                            <input type=\"text\" placeholder='输入名字'\r\n                                ref = {(content)=>{this.nickNameRef = content}}\r\n                            />\r\n                        </div>,\r\n                footer: <div className='sb_dlg_footer_inner'>\r\n                            <div className=\"button\" onClick={this.confirmAddFriend}>确定</div>\r\n                        </div>\r\n            })\r\n        }\r\n        this.confirmAddFriend = ()=>{\r\n            sdk.conn.subscribe({\r\n                to: this.nickNameRef.value.trim(),\r\n                message: '你好，我是张治国，交个朋友呗！'\r\n            })\r\n            dialog.close()\r\n        }\r\n\r\n    }\r\n    // 组件卸载前，把事件监听去掉\r\n    componentWillUnmount(){\r\n        eventEmitter.removeListener('presence', this.handlePresence)\r\n    }\r\n\r\n    render(){\r\n        let {chatId, allFriend} = this.props\r\n        return (\r\n            <div className=\"sessionList\">\r\n                <div className='addFriendBtn'>\r\n                    <i className=\"iconfont icon-hao\" onClick={this.showAddFriend}></i>\r\n                </div>\r\n                <ul>{\r\n                    allFriend.length===0 ? null : allFriend.map((item)=>{\r\n                        let isSelected = chatId === item.name ? true : false\r\n                        return (\r\n                            // 这里name就是唯一的，故可做key属性值\r\n                            <li key={item.name} className={isSelected ? 'list listActive' : 'list'}>\r\n                                <SessionItem  friend={item}/>\r\n                            </li>\r\n                        )\r\n                    })\r\n                }</ul>\r\n\r\n                {/* {allFriend.length===0 ? null : allFriend.map((item)=>{   \r\n                    let isSelected = chatId === item.name ? true : false\r\n                    return <SessionItem key={item.name} friend={item} isSelected={isSelected}/>\r\n                })} */}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n@connect(\r\n    ()=>{return {}},\r\n    {currentSessionActon}\r\n)\r\nclass SessionItem extends Component{\r\n    componentWillMount(){\r\n        this.itemClick = ()=>{\r\n            let {currentSessionActon, friend} = this.props\r\n            currentSessionActon(friend)     //已经改造，connect函数自动dispatch\r\n        }  \r\n    }\r\n    shouldComponentUpdate(nextProps, nextState){\r\n        // 问题点：以前好友A发一条消息，渲染四次，因为好友列表中有四个好友\r\n        // 改善：好友A发一条消息，只要好友A渲染（渲染目的是添加消息预览）,其他好友不渲染\r\n        // 当上一个好友对象和新的好友对象不同时，此函数返回true，进行渲染\r\n        // 为什么不同？因为如果是好友A发的消息，就会在A对象上添加newMsg属性，故而不同\r\n        // 附加：如果上一次点击的和这次点击的不同，返回true进行渲染，渲染两次（一个是去掉active, 一个是加上active） \r\n        return !shallowequal(this.props.friend, nextProps.friend) || !shallowequal(this.props.isSelected, nextProps.isSelected)\r\n    }\r\n    render(){      \r\n        let {friend} = this.props    \r\n        let url = {\r\n            pathname: `/chat/single/${friend.name}`,\r\n            state: {'chatType': 'single', 'friendName': `${friend.name}`}\r\n        }\r\n        // 点击Link链接，渲染chat页面（不重载），读取location信息，传给sessionList子组件\r\n        return (\r\n            <div className='sessionItem'>\r\n                <Link to={url} onClick={this.itemClick} >  \r\n                    <div className=\"sm_lf\">\r\n                        <img src={require('../../../img/photo_other.jpg')} alt=\"\"/>\r\n                    </div>\r\n                    <div className=\"sm_rt\">\r\n                        <h3>{friend.name}</h3>\r\n                        <p>{friend.newMsg ? friend.newMsg.value : ''}</p>\r\n                    </div>\r\n                </Link>\r\n            </div>\r\n        )\r\n    }\r\n}\r\nexport default SessionList","import React, { Component } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport SlideBar from './sliderBar'\r\nimport BubblePanel from './bubblePanel'\r\nimport SessionList from './sessionList'\r\nimport {init} from '../../data/actions/message'\r\nimport './index.css'\r\n\r\n@connect(\r\n    ()=>({}),\r\n    {init}\r\n)\r\nclass Chat extends Component{\r\n    componentWillMount(){\r\n        this.props.init()\r\n    }\r\n    render(){    \r\n        // 点击Link链接，渲染chat页面（不重载），读取location信息，传给sessionList子组件，现在换了一种方式，此处没用上\r\n        let {chatType, friendName} = Object.assign({}, this.props.location.state)\r\n        return (\r\n            <div className=\"ctn-chat\">\r\n                <SlideBar />\r\n                <SessionList chatType={chatType} chatId={friendName}/>\r\n                <BubblePanel chatType={chatType} chatId={friendName} />\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Chat","import React, { Component } from 'react'\r\nimport { Provider } from 'react-redux'\r\nimport store from './data/store'\r\nimport history from './history/history'\r\nimport conn from './sdk/init'\r\nimport {getToken} from './utils/token'\r\nimport Login from './component/sign/Login'\r\nimport Signup from './component/sign/Signup'\r\nimport Chat from './component/chat/index'\r\nimport {HashRouter as Router, Route} from 'react-router-dom' \r\nimport './App.css'\r\n\r\n\r\n\r\nwindow.sdk = { conn: conn }\r\n\r\nclass Home extends Component{\r\n    render(){\r\n        let token = getToken()\r\n        return (\r\n            <div>\r\n                {!token && \r\n                    history.location.pathname!=='/login' ? history.push('/login') : \r\n                null}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default class App extends Component{\r\n    render(){\r\n        return (\r\n            <Provider store={store}>\r\n                <Router>\r\n                    <div className='app_Wrapper'>\r\n                        <Route path=\"/\" component={Home} />\r\n                        <Route path=\"/signUp\" component={Signup} />\r\n                        <Route path=\"/login\" component={Login} />\r\n                        <Route path=\"/chat\" component={Chat} /> \r\n                        {/* <Route path=\"/chat/:chatType/:chatId\" component={Chat} />  */}\r\n                    </div>\r\n                </Router>\r\n            </Provider>\r\n        )\r\n    }\r\n}","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (!isLocalhost) {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      } else {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport registerServiceWorker from './registerServiceWorker'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\nregisterServiceWorker();\n"],"sourceRoot":""}