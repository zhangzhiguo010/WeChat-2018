{"version":3,"sources":["img/photo_other.jpg","img/photo.jpg","data/store.js","data/reducers/signUpReducer.js","data/reducers/loginReducer.js","data/reducers/session.js","data/reducers/message.js","history/history.js","sdk/init.js","utils/token.js","decorators/seferender.js","component/common/tooltip/index.js","component/sign/SignBasic.js","component/sign/Login.js","data/actions/loginAction.js","component/sign/Signup.js","data/actions/signUpAction.js","component/chat/sliderBar/index.js","data/actions/actionCreator.js","data/actions/session.js","utils/event.js","data/actions/message.js","component/common/dialog/index.js","component/chat/bubblePanel/index.js","component/common/icon/index.js","component/chat/sessionList/index.js","component/chat/index.js","App.js","registerServiceWorker.js","index.js"],"names":["module","exports","__webpack_require__","p","reducers","combineReducers","signUp","initState","arguments","length","undefined","status","action","type","Object","assign","payload","login","currentSession","session","allFriend","toConsumableArray","message","to","msgList","currentMsg","msg","list","push","addTextMsg","middlewares","thunk","store","applyMiddleware","apply","createStore","history","createHashHistory","conn","WebIM","connection","isMultiLoginSessions","config","https","url","xmppURL","heartBeatWait","autoReconnectNumMax","autoReconnectInterval","apiUrl","apiURL","isHttpDNS","isWindowSDK","isAutoLogin","encrypt","delivery","token","getToken","d","SignBasic","active","errorHandler","e","alert","displayName","method","target","forEach","blankFn","unsafe","prototype","report","console","log","call","this","name","stack","state","props","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","hint","header","button","account","footer","aLink","showNickName","userName","password","nickName","_this2","setState","changeInput","event","value","trim","handleSubmit","ev","preventDefault","handleSignUp","handleLogin","react_default","a","createElement","className","Link","placeholder","onChange","onClick","Component","Tooltip","_this$props","content","concat","defaultProps","time","timer","close","ReactDOM","unmountComponentAtNode","parentNode","removeChild","tooltip","show","document","body","appendChild","render","tooltip_Tooltip","clearTimeout","setTimeout","Login","connect","loginToServer","options","dispatch","getState","Promise","resolve","reject","success","error","err","sdk","open","data","user","pwd","appKey","appkey","then","sign_SignBasic","SignUp","signUpToServer","onSuccess","onError","registerUser","username","toLowerCase","nickname","SlideBar","tokenUser","src","require","alt","actionCreator","_len","key","Array","_key","_len2","_key2","item","index","currentSessionActon","fetchAllFriendAction","fetchAllFriend","getRoster","response","myFriends","filter","subscription","utils_event","EventEmitter","addTextMsgAaction","addTextMsgAndChangeFriendList","who","from","newAllFriend","map","newItem","objectSpread","newMsg","container","chat_bubblePanel","chatType","id","getUniqueId","set","roomType","serverMsgId","fromMe","fail","send","BubblePanel","aloneMessage","handleUserInput","sendMessage","_this2$props","getAloneMessage","_this2$props2","mainRef","scrollTop","scrollHeight","_this3","ref","bubblePanel_MessageItemErrorWrapper","cols","rows","MessageItemErrorWrapper","_this4","hasError","info","bubblePanel_MessageItem","MessageItem","mi_item","classnames","you","me","Icon","classNames","defineProperty","iconfont","Dialog","closeDialog","onClose","title","showMask","icon","common_dialog","dialog_Dialog","SessionList","eventEmitter","on","dialog","bind","accept","subscribed","subscribe","unsubscribed","showAddFriend","nickNameRef","confirmAddFriend","removeListener","handlePresence","chatId","isSelected","sessionList_SessionItem","friend","SessionItem","itemClick","nextProps","nextState","shallowequal","pathname","friendName","Chat","init","listen","onOpened","onTextMessage","onRoster","onPresence","emit","_Object$assign","location","chat_sliderBar","chat_sessionList","window","Home","App","es","HashRouter","Route","path","component","Signup","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","catch","App_App","getElementById","URL","process","origin","addEventListener","fetch","headers","get","indexOf","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.221928a3.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/photo_other.1969756e.jpg\";","module.exports = __webpack_public_path__ + \"static/media/photo.1fa99390.jpg\";","import { createStore, combineReducers, applyMiddleware} from 'redux'\r\nimport thunk from 'redux-thunk';\r\nimport { signUpReducer } from './reducers/signUpReducer' \r\nimport { loginReducer } from './reducers/loginReducer'\r\nimport { currentSessionReducer } from './reducers/session'\r\nimport { messageReducer } from './reducers/message'\r\n\r\nconst reducers = combineReducers({\r\n    signUp: signUpReducer,\r\n    login: loginReducer,\r\n    currentSession: currentSessionReducer,\r\n    message: messageReducer\r\n})\r\nconst middlewares = [thunk]\r\nconst store = applyMiddleware(...middlewares)(createStore)(reducers)\r\n\r\nexport default store\r\n\r\n","// 初始：0， 进行中：1， 成功：2，  失败：3\r\n\r\nconst signUpReducer = (initState={status: 0}, action)=>{\r\n    switch(action.type){\r\n        case 'SIGNUP':\r\n            return Object.assign({}, initState, {status: action.payload.status})\r\n        default:\r\n            return initState\r\n    }\r\n}\r\nexport { signUpReducer }","// 初始：0， 进行中：1， 成功：2，  失败：3\r\n\r\nconst loginReducer = (initState={status: 0}, action)=>{\r\n    switch(action.type){\r\n        case 'LOGIN':\r\n            return Object.assign({}, initState, {status: action.payload.status})\r\n        default:\r\n            return initState\r\n    }\r\n}\r\nexport { loginReducer }","function currentSessionReducer(initState={\r\n    session: null,\r\n    allFriend: []\r\n}, action){\r\n    switch(action.type){\r\n        case 'CURRENT_SESSION':\r\n            return Object.assign({}, initState, {session: action.payload.session})\r\n        case 'FETCH_ALL_FRIEND':\r\n            return Object.assign({}, initState, {allFriend: [...action.payload.allFriend]})\r\n        default:\r\n            return initState\r\n    }\r\n}\r\n\r\nexport { currentSessionReducer }","// msgList = { '好友1': [{好友1的消息}, {我发的消息}], '好友2': [{我发的消息}, {好友2发的消息}]}\r\n\r\nfunction messageReducer(initState={\r\n    msgList: {},\r\n    currentMsg: []\r\n}, action){\r\n    switch(action.type){\r\n        case 'ADD_TEXT_MSG':            \r\n            return Object.assign({}, initState, {msgList: addTextMsg(action.payload.to, action.payload.message, initState.msgList)})\r\n        case 'GET_ALONE_MSG':\r\n            return Object.assign({}, initState, {currentMsg: filterMsgList(action.payload.to, initState.msgList)})\r\n        default:\r\n            return initState\r\n    }\r\n}\r\n\r\nexport { messageReducer }\r\n\r\n\r\nfunction filterMsgList(to, msgList){\r\n    return msgList[to] ? [...msgList[to] ] : []\r\n}\r\n\r\n\r\n// to: 和我对话的好友\r\n// msg: 消息内容（可能是我发的也可能是朋友发的）\r\n// msgList: 全部消息\r\nfunction addTextMsg(to, msg, msgList){\r\n    let list = msgList[to] || []\r\n    list.push(msg)\r\n    msgList[to] = list\r\n    return Object.assign({}, msgList)   //想要触发bubblePanel组件渲染，此处必须生成新的地址，原因未知\r\n}","import createHashHistory from 'history/createHashHistory';\r\nconst history = createHashHistory()\r\nexport default history","let conn = new WebIM.connection({\n    isMultiLoginSessions: WebIM.config.isMultiLoginSessions,\n    https: false,\n    url: WebIM.config.xmppURL,\n    heartBeatWait: WebIM.config.heartBeatWait,\n    autoReconnectNumMax: WebIM.config.autoReconnectNumMax,\n    autoReconnectInterval: WebIM.config.autoReconnectInterval,\n    apiUrl: WebIM.config.apiURL,\n    isHttpDNS: WebIM.config.isHttpDNS,\n    isWindowSDK: WebIM.config.isWindowSDK,\n    isAutoLogin: true,\n    encrypt: WebIM.config.encrypt,\n    delivery: WebIM.config.delivery\n});\n\nexport default conn","let token = null\r\nconst getToken = ()=>{\r\n    return token\r\n}\r\nconst setToken = (newToken)=>{\r\n    return token = newToken\r\n}\r\nexport {getToken, setToken}\r\n\r\n\r\n\r\n// let tokenFun = !function(){\r\n//     let  token = null\r\n//     const setToken = (newToken)=>{\r\n//         return token = newToken\r\n//     }\r\n//     const getToken = ()=>{\r\n//         return token\r\n//     }\r\n//     return {\r\n//         setToken: setToken,\r\n//         getToken: getToken\r\n//     }\r\n// }()\r\n\r\n\r\n\r\n\r\n\r\n\r\n","export default function safeRender(config){\r\n    return function(target){ \r\n        if(config.active){\r\n            [\r\n                'render',\r\n                'componentWillMount',\r\n                'componentDidMount',\r\n                'componentWillReceiveProps',\r\n                'componentWillUpdate',\r\n                'componentDidUpdate',\r\n                'compoentnWillUnmount',\r\n                'shouldComponentUpdate'\r\n            ].forEach((method)=>{\r\n                let blankFn =  method === 'shouldComponentUpdate' ? ()=>{return true} : ()=>{return null}\r\n                let unsafe = target.prototype[method] || blankFn    // 原来的方法  \r\n                config.errorHandler = config.errorHandler || function(report){\r\n                    console.log(report)\r\n                }             \r\n\r\n                target.prototype[method] = function(){              // 修改原方法\r\n                    try{\r\n                        return unsafe.call(this, arguments)\r\n                    }catch(e){\r\n                        let report = {\r\n                            displayName: target.name,   // 组件名\r\n                            method: method,             // 方法名\r\n                            message: e.stack,           // 出了什么问题？\r\n                            state: this.state,\r\n                            props: this.props\r\n                        }\r\n                        config.errorHandler(report)\r\n                        return blankFn.call(this, arguments)    // shouldComponentUpdate 和 render 函数在报错的时候也应该有返回值\r\n                    }\r\n                }\r\n            })\r\n        }\r\n    \r\n    }\r\n}","import React, { Component } from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport './index.css'\r\n// tooltip样式 48分钟\r\nclass Tooltip extends Component{\r\n    static defaultProps = {\r\n        time: 3000,         //3s自动消失\r\n        type: 'success',    //默认成功的样式\r\n        content: ''         // 显示的内容\r\n    }\r\n    render(){\r\n        let {type, content} = this.props\r\n        return (\r\n            <div className=\"tooltips\">\r\n                <div>{`${type}: ${content}`}</div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nlet d\r\nlet timer = null\r\nfunction show(props){\r\n    if(d){\r\n        close()\r\n    }\r\n    d = document.createElement('div')\r\n    document.body.appendChild(d)\r\n    ReactDOM.render(<Tooltip {...props} />, d)\r\n\r\n    timer && clearTimeout(timer)\r\n    timer = setTimeout(() => {\r\n        close()\r\n    }, props.time || 3000);\r\n}\r\nfunction close(){\r\n    if(d){\r\n        ReactDOM.unmountComponentAtNode(d)\r\n        d.parentNode.removeChild(d)\r\n        d = null\r\n    }\r\n}\r\n\r\nconst tooltip = {show, close}\r\n\r\nexport default tooltip","import React, { Component } from 'react'\r\nimport { Link } from 'react-router-dom' \r\nimport safeRender from '../../decorators/seferender'\r\nimport './signBasic.css'\r\n\r\n@safeRender({\r\n    active: true,\r\n    errorHandler: function(e){\r\n        alert(e.displayName + \"----\" + e.method)\r\n    }\r\n})\r\n\r\nclass SignBasic extends Component{\r\n    constructor(props){\r\n        super(props)\r\n        this.state = {\r\n            hint: {\r\n                header: '',\r\n                button: '',\r\n                account: '',\r\n                footer: '',\r\n                aLink: '',\r\n                showNickName: false\r\n            },\r\n            userName: '',\r\n            password: '',\r\n            nickName: ''\r\n        }\r\n    }\r\n    componentWillMount(){\r\n        this.props.hint===\"signUp\" ? \r\n        this.setState({ hint: {header: '注册', button: '注册', account: '已有账户', footer: '立即登录', aLink: '/login',  showNickName: true } }) :             \r\n        this.setState({ hint: {header: '登录', button: '登录', account: '没有账户', footer: '立即注册', aLink: '/signUp', showNickName: false} })\r\n\r\n        this.changeInput = (event)=>{\r\n            switch(event.target.name){\r\n                case 'userName':\r\n                    return  this.setState({userName: event.target.value})\r\n                case 'password':\r\n                    return  this.setState({password: event.target.value.trim()})\r\n                case 'nickName':\r\n                    return  this.setState({nickName: event.target.value})\r\n                default:\r\n                    return \r\n            }\r\n        }\r\n\r\n        this.handleSubmit = (ev)=>{\r\n            ev.preventDefault()\r\n            this.props.hint===\"signUp\" ? \r\n            this.props.handleSignUp(this.state) : \r\n            this.props.handleLogin(this.state)\r\n        }\r\n    } \r\n    render(){\r\n        return (\r\n            <div className=\"signBasic\">\r\n                <header>\r\n                    <div className='header_inner'>\r\n                        <h1 className='logo'>张治国 聊天小作品</h1>\r\n                        <div className='signUpBtn'>\r\n                            <Link to={this.state.hint.aLink}>{this.state.hint.footer}</Link>\r\n                        </div>\r\n                    </div>\r\n                </header>\r\n                <main>\r\n                    <div className='main_inner'>\r\n                        <form>\r\n                            <h3>{this.state.hint.header}</h3>\r\n                            <div className='row'>\r\n                                <i className=\"iconfont icon-photo\"></i>\r\n                                <input type=\"text\" name=\"userName\" placeholder=\"用户名\" className=\"input firstInput\"\r\n                                    value={this.state.userName} \r\n                                    onChange={this.changeInput}\r\n                                />\r\n                            </div>\r\n                            <div className='row'>\r\n                                <i className=\"iconfont icon-clock\"></i>\r\n                                <input type=\"password\" name=\"password\" placeholder=\"密码\" className=\"input\"\r\n                                    value={this.state.password} \r\n                                    onChange={this.changeInput}\r\n                                />\r\n                            </div>\r\n\r\n                            {this.state.hint.showNickName ? \r\n                                <div className='row'>\r\n                                    <i className=\"iconfont icon-photo\"></i>\r\n                                    <input type=\"text\" name=\"nickName\" placeholder=\"输入昵称\" className=\"input\"\r\n                                        value={this.state.nickName} \r\n                                        onChange={this.changeInput}\r\n                                    /> \r\n                                </div>\r\n                            : null}\r\n                                \r\n                            <div className='button_wrapper'>\r\n                                <input type=\"submit\" name=\"submit\" className=\"button\"\r\n                                    value={this.state.hint.button}\r\n                                    onClick={this.handleSubmit}\r\n                                />\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </main>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\nexport default SignBasic","import React, { Component } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { loginToServer} from '../../data/actions/loginAction'\r\nimport SignBasic from './SignBasic'\r\nimport tooltip from '../../component/common/tooltip/index'\r\nimport history from '../../history/history'\r\nimport {setToken} from '../../utils/token'\r\n\r\n@connect(\r\n    ()=>({}),\r\n    {loginToServer: loginToServer}\r\n)\r\nclass Login extends Component{\r\n    componentWillMount(){\r\n        this.handleLogin = (data)=>{\r\n            if(!data.userName || !data.password){\r\n                tooltip.show({\r\n                    type: 'error',\r\n                    content: '账号密码不能为空'\r\n                })\r\n                return \r\n            }\r\n            let options = { \r\n                user: data.userName.trim(),\r\n                pwd: data.password,\r\n                appKey: WebIM.config.appkey,\r\n                apiUrl: WebIM.config.apiURL,\r\n            }\r\n            this.props.loginToServer(options).then(\r\n                (token)=>{\r\n                    setToken(token)                 // 登录成功后要把token记录下来                    \r\n                    history.push('/chat')\r\n                },\r\n                (err)=>{\r\n                    tooltip.show({\r\n                        type: 'error',\r\n                        content: '登录失败了'\r\n                    })\r\n                }\r\n            )\r\n        }\r\n    }\r\n    render(){\r\n        return (\r\n            <SignBasic hint=\"login\" handleLogin={this.handleLogin}/>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Login ","const loginToServer = (options)=>{\r\n    return (dispatch, getState)=>{\r\n        return new Promise((resolve, reject)=>{\r\n            options.success = (token)=>{\r\n                resolve(token)\r\n            }\r\n            options.error = (err)=>{ \r\n                reject(err)\r\n            }\r\n            sdk.conn.open(options) \r\n        })\r\n    }\r\n}\r\n\r\nexport { loginToServer }\r\n","import React, { Component } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { signUpToServer} from '../../data/actions/signUpAction'\r\nimport SignBasic from './SignBasic'\r\nimport tooltip from '../../component/common/tooltip/index'\r\nimport history from '../../history/history'\r\n\r\n\r\n@connect(\r\n    ()=>({}),\r\n    {signUpToServer: signUpToServer}\r\n)\r\nclass SignUp extends Component{\r\n    componentWillMount(){\r\n        // handleSignUp做三件事：收集用户输入、和服务器建立联系、指定成功任务和失败任务\r\n        this.handleSignUp = (data)=>{\r\n            if(!data.userName || !data.password || !data.nickName){\r\n                tooltip.show({\r\n                    type: 'error',\r\n                    content: '账号密码不能为空'\r\n                })\r\n                return \r\n            }\r\n            let options = { \r\n                username: data.userName.trim().toLowerCase(),\r\n                password: data.password,\r\n                nickname: data.nickName,\r\n                appKey: WebIM.config.appkey,\r\n                apiUrl: WebIM.config.apiURL,\r\n            }\r\n            this.props.signUpToServer(options).then(\r\n                ()=>{\r\n                    history.push('/login')          //注册成功时跳转到登录页面，让用户输入用户名和密码后即可正常使用\r\n                },\r\n                ()=>{\r\n                    tooltip.show({                  //注册失败时，给出一个提示\r\n                        content: '注册失败了',\r\n                        type: 'error'\r\n                    })\r\n                }\r\n            )\r\n        }\r\n    }\r\n    render(){\r\n        return (\r\n            <SignBasic hint=\"signUp\" handleSignUp={this.handleSignUp}/>\r\n        )\r\n    }\r\n}\r\n\r\nexport default SignUp ","\r\n// import actionCreator  from './actionCreator'\r\n// const signUpAction = actionCreator('SIGNUP', 'status') \r\n\r\nconst signUpToServer = (options)=>{\r\n    return (dispatch, getState)=>{\r\n        return new Promise((resolve, reject)=>{\r\n            // options对象里应该定义响应成功和失败的函数，但是被我定义在了then里面\r\n            let onSuccess = options.success\r\n            let onError = options.error\r\n            options.success = ()=>{\r\n                onSuccess && onSuccess()    //此处不执行\r\n                resolve()                   //注册成功时执行该函数，在then中被指定\r\n            }\r\n            options.error = ()=>{\r\n                onError && onError()    \r\n                reject()\r\n            }\r\n            sdk.conn.registerUser(options) \r\n        })\r\n    }\r\n}\r\nexport { signUpToServer }","import React, { Component } from 'react'\r\nimport {getToken} from '../../../utils/token'\r\nimport './index.css'\r\n\r\nclass SlideBar extends Component{\r\n    render(){\r\n        let tokenUser = getToken()\r\n        let username = tokenUser ? tokenUser.user.username : ''\r\n        return (\r\n            <div className=\"sb\">\r\n                <div className='sb_header'>\r\n                    <div className=\"photo_wrapper avator\">\r\n                        <img src={require('../../../img/photo.jpg')} alt=\"\"/>\r\n                    </div>\r\n                    <p className='myNickName'>{username}</p>\r\n                </div>\r\n                <div className='sb_main'>\r\n                    <div className=\"icon_wrapper chat\">\r\n                        <i className=\"iconfont icon-chat\"></i>\r\n                    </div>\r\n                </div>\r\n                <div className='sb_footer'>\r\n                    <div className=\"icon_wrapper setting\">\r\n                        <i className=\"iconfont icon-shezhi\"></i>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default SlideBar\r\n\r\n\r\n\r\n/*************** 此模块是SlideBar组件 *******************/\r\n/* 输入： */\r\n// 得到token，得到登录者名称\r\n\r\n/* 输出： */\r\n// 聊天页面左边栏\r\n","// key = ['name', 'age', 'sex']\r\n// value = ['zhang', 18, 'nan']\r\nconst actionCreator = (type, ...key)=>{\r\n    return (...value)=>{\r\n        let action = { type: type, payload: {} }\r\n        key.forEach((item, index)=>{\r\n            action.payload[key[index]] = value[index]\r\n        })\r\n        return action\r\n    }\r\n}\r\n\r\nexport default actionCreator\r\n","import actionCreator  from './actionCreator'\r\n\r\nconst currentSessionActon = actionCreator('CURRENT_SESSION', 'session')\r\nconst fetchAllFriendAction = actionCreator('FETCH_ALL_FRIEND', 'allFriend')\r\n\r\nfunction fetchAllFriend(){           // 找到互为好友的人\r\n    return (dispatch, getState)=>{\r\n        sdk.conn.getRoster({\r\n            success: (response)=>{     \r\n                let myFriends = response.filter((item)=>{\r\n                    return item.subscription === 'both'\r\n                })\r\n                dispatch(fetchAllFriendAction(myFriends))\r\n            },\r\n            error: (err)=>{}\r\n        })\r\n    }\r\n}\r\n\r\n// 来到消息就执行该函数\r\n// 接收到一条消息，可能是我发送的，也可能是好友发送的\r\n// 遍历好友数组，假设消息的发送者是好友AAA，就给它添加newMsg属性，属性值就是他发送的那一条消息\r\n// 在好友列表那个组件里，判断是否有newMsg属性，有的话就当做预览展示出来\r\nfunction changeFriendListWithMsg(msg){\r\n    return (dispatch, getState)=>{\r\n        let name = msg.body ? msg.body.to : msg.from    // 消息的发送者，有body时发送人是我，没有body时发送人是好朋友\r\n        let allFriend = getState().currentSession.allFriend     //所有好友\r\n        let newAllFriend = allFriend.map((item)=>{      // 新的好友列表\r\n            let newItem = {...item}\r\n            if(newItem.name === name){\r\n                newItem.newMsg = msg\r\n            }\r\n            return newItem\r\n        })\r\n        dispatch(fetchAllFriendAction(newAllFriend))\r\n    }\r\n}\r\n\r\nexport { fetchAllFriend, currentSessionActon, changeFriendListWithMsg }","import EventEmitter from 'eventemitter3'\r\n\r\nexport default new EventEmitter()","import actionCreator  from './actionCreator'\r\nimport {getToken} from '../../utils/token'\r\nimport {fetchAllFriend, changeFriendListWithMsg} from './session'\r\nimport eventEmitter from '../../utils/event'\r\n\r\nconst addTextMsgAaction = actionCreator('ADD_TEXT_MSG', 'to', 'message')\r\n\r\n// const getAloneMsgAaction = actionCreator('GET_ALONE_MSG', 'message')\r\n\r\nfunction addTextMsgAndChangeFriendList(who, message){\r\n    return (dispatch, getState)=>{\r\n        dispatch(addTextMsgAaction(who, message))\r\n        dispatch(changeFriendListWithMsg(message))\r\n    }\r\n}\r\n\r\nfunction init(){\r\n    return (dispatch, getState)=>{\r\n        sdk.conn.listen({   \r\n             //监听：链接成功时，立即执行此函数\r\n            onOpened: ()=>{  \r\n                dispatch(fetchAllFriend())\r\n            },\r\n            // 监听：消息发送到服务器，立即执行此函数\r\n            onTextMessage: (message)=>{\r\n                message.value = message.value || message.data  \r\n                dispatch(addTextMsgAndChangeFriendList(message.from, message))\r\n            },\r\n            onRoster: (response)=>{ \r\n                dispatch(fetchAllFriend())\r\n            },\r\n            onPresence: (message)=>{ \r\n                eventEmitter.emit('presence', message)\r\n            }\r\n        }) \r\n    }\r\n}\r\n\r\nfunction addTextMsg(to, message, chatType){\r\n    return (dispatch, getState)=>{\r\n        let name = getToken().user.nickname\r\n        let id = sdk.conn.getUniqueId();              \r\n        let msg = new WebIM.message('txt', id)\r\n        msg.set({\r\n            msg: message,                 \r\n            to: to,               \r\n            roomType: false,\r\n            success:(id, serverMsgId)=>{ \r\n                msg.fromMe = true   // 用来区分信息是发送还是接收\r\n                msg.from = name    // from：我的名字\r\n                dispatch(addTextMsgAndChangeFriendList(to, msg))\r\n            },\r\n            fail: (e)=>{\r\n                alert('消息到服务器失败')\r\n            }\r\n        });\r\n        msg.body.chatType = chatType\r\n        sdk.conn.send(msg.body);\r\n    }\r\n}\r\n\r\nexport {init, addTextMsg }\r\n\r\n\r\n\r\n\r\n","import React, { Component } from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport Icon from '../icon/index'\r\nimport './index.css'\r\n\r\nclass Dialog extends Component{\r\n    static defaultProps = {\r\n      showMask: true\r\n    }\r\n    componentWillMount(){\r\n        this.closeDialog = ()=>{\r\n            close()\r\n            this.props.onClose && this.props.onClose()    //执行callback，前提是存在 \r\n        }\r\n    }\r\n\r\n    render(){\r\n        let {title, content, footer, showMask} = this.props       \r\n        return (\r\n            <div className='dlg_wrapper'>\r\n                {showMask ? \r\n                    <div className='dlg_mask' /> : \r\n                null}\r\n                <div className='dlg'>\r\n                    <div className='dlg_closeBtn' onClick={this.closeDialog}>\r\n                        <Icon type='guanbi' />\r\n                    </div>\r\n                    <div className='dlg_header'>{title}</div>\r\n                    <div className='dlg_main'>{content}</div>\r\n                    <div className='dlg_footer'>{footer}</div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\nlet container\r\nfunction show(props){\r\n    container && close()\r\n    if(container){\r\n        close()\r\n    }\r\n    container = document.createElement('div')\r\n    document.body.appendChild(container)\r\n    ReactDOM.render(<Dialog {...props}/>, container)\r\n}\r\n\r\nfunction close(){\r\n    if(container){\r\n        ReactDOM.unmountComponentAtNode(container)\r\n        container.parentNode.removeChild(container)\r\n        container = null\r\n    }\r\n}\r\n\r\n\r\nexport default {show, close}\r\n","import React, { Component } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport classnames from 'classnames'\r\nimport {addTextMsg} from '../../../data/actions/message'\r\nimport './index.css'\r\n\r\n@connect(\r\n    (state)=>{return {\r\n        session: state.currentSession.session,      // sessionList组件中我选择的好友（我点击的Link）\r\n        msgList: state.message.msgList              // 所有好友所有信息\r\n    }},\r\n    {addTextMsg}\r\n)\r\nclass BubblePanel extends Component{\r\n    constructor(props){\r\n        super(props)\r\n        this.state = {\r\n            message: '',\r\n            aloneMessage: ''\r\n        }\r\n    }\r\n    componentWillMount(){\r\n        this.handleUserInput = (ev)=>{\r\n            this.setState({message: ev.target.value})\r\n        }\r\n        this.sendMessage = ()=>{\r\n            let {addTextMsg, session, chatType} = this.props\r\n            let {message} = this.state\r\n            this.setState({message: ''})\r\n            session && this.state.message.trim()!=='' && addTextMsg(session.name, message, chatType)\r\n        }\r\n        this.getAloneMessage = ()=>{\r\n            let {msgList, session} = this.props\r\n            if(!session){return []}\r\n            let name = session!==null ? session.name : ''\r\n            return msgList[name] || []\r\n        }\r\n    }\r\n    componentDidUpdate(){\r\n        this.mainRef.scrollTop = this.mainRef.scrollHeight\r\n    }\r\n    render(){\r\n        let {session} = this.props\r\n        let aloneMessage = this.getAloneMessage()\r\n        return (\r\n            <div className='bp'>\r\n                <div className=\"bp_header\">\r\n                    {session ? session.name : ''}\r\n                </div>\r\n                <div className=\"bp_main\" ref={(content)=>{this.mainRef = content}}>\r\n                    <div className=\"timeHint\"></div>\r\n                    {\r\n                        aloneMessage.map((item)=>{\r\n                            return <MessageItemErrorWrapper key={item.id} msg={item} />\r\n                        })\r\n                    }\r\n                </div>\r\n                <div className=\"bp_footer\">\r\n                    <textarea name=\"\" id=\"\" cols=\"30\" rows=\"10\" placeholder='输入消息' className='textArea' \r\n                        value={this.state.message}\r\n                        onChange={this.handleUserInput} \r\n                    />\r\n                    <div className='sendButton' onClick={this.sendMessage}>发送</div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default BubblePanel\r\n\r\n\r\nclass MessageItemErrorWrapper extends Component{\r\n    constructor(props){\r\n        super(props)\r\n        this.state = {\r\n            hasError: false\r\n        }\r\n    }\r\n    componentDidCatch(err, info){\r\n        this.setState({\r\n            hasError: true\r\n        })\r\n    }\r\n    render(){\r\n        if(this.state.hasError){\r\n            return <div>出错了，请联系RD修复</div>\r\n        }\r\n        return <MessageItem msg={this.props.msg} />\r\n    }\r\n}\r\n\r\n\r\nclass MessageItem extends Component{\r\n    render(){\r\n        let {msg} = this.props\r\n        // 如何区分收到的还是发出的？在发出的对象上添加fromMe属性，有该属性就是我发出，没有该属性就是我收到\r\n        let fromMe = msg.fromMe ? true : false  \r\n        let mi_item = classnames({\r\n            'mi_item': true,\r\n            'you': !fromMe,\r\n            'me': fromMe\r\n        })      \r\n        return (\r\n            <div className={mi_item}>\r\n                <figure className='mi_photo'>\r\n                    <img src={require('../../../img/photo_other.jpg')} alt=\"头像\"/>\r\n                </figure>\r\n                <div className='mi_text'>\r\n                    {msg.value}\r\n                    <div className='san'></div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n","import React, { Component } from 'react'\r\nimport classnames from 'classnames'\r\n\r\nclass Icon extends Component{\r\n    render(){\r\n        let {type} = this.props\r\n        let classNames = classnames({\r\n            'iconfont': true,\r\n            ['icon-' + type]: true\r\n        })\r\n        \r\n        return <span className={classNames}></span>\r\n    }\r\n}\r\n\r\nexport default Icon","import React, { Component } from 'react'\r\nimport dialog from '../../common/dialog/index'\r\nimport { Link } from 'react-router-dom' \r\nimport {connect} from 'react-redux'\r\nimport {currentSessionActon} from '../../../data/actions/session'\r\nimport eventEmitter from '../../../utils/event'\r\nimport shallowequal from 'shallowequal'\r\nimport './index.css'\r\n\r\n@connect(\r\n    (state)=>{return {allFriend: state.currentSession.allFriend}}\r\n)\r\nclass SessionList extends Component{\r\n    componentWillMount(){    \r\n        // 别人加我为好友时，弹出框 \r\n        eventEmitter.on('presence', (message)=>{\r\n            if (message.type === 'subscribe') {\r\n                dialog.show({\r\n                    title: '添加好友',\r\n                    content: <div className='sl_dlg_header_inner'>\r\n                                <p className='who'>{message.from}邀请加你为好友</p>\r\n                                <p className='message'>留言：{message.status}</p>\r\n                            </div>,\r\n                    footer: <div className='sl_dlg_footer_inner'>\r\n                                <button className='reject' onClick={this.reject.bind(this, message)}>拒绝</button>\r\n                                <button className='accept' onClick={this.accept.bind(this, message)}>同意</button>\r\n                            </div>\r\n                })\r\n            } \r\n        })\r\n        this.accept = (message)=>{\r\n            sdk.conn.subscribed({     \r\n                to: message.from,\r\n                message : '[resp:true]'\r\n            });\r\n            sdk.conn.subscribe({        //需要反向添加对方好友\r\n                to: message.from,\r\n                message : '[resp:true]'\r\n            });\r\n            dialog.close()\r\n        }\r\n        this.reject = (message)=>{\r\n            sdk.conn.unsubscribed({\r\n                to: message.from,\r\n                message : 'rejectAddFriend'\r\n            })\r\n            dialog.close()\r\n        }\r\n\r\n        // 我加别人为好友时，弹出框\r\n        this.showAddFriend = ()=>{\r\n            dialog.show({\r\n                title: '添加好友',\r\n                content: <div className='sb_dlg_header_inner'>\r\n                            <input type=\"text\" placeholder='输入名字'\r\n                                ref = {(content)=>{this.nickNameRef = content}}\r\n                            />\r\n                        </div>,\r\n                footer: <div className='sb_dlg_footer_inner'>\r\n                            <div className=\"button\" onClick={this.confirmAddFriend}>确定</div>\r\n                        </div>\r\n            })\r\n        }\r\n        this.confirmAddFriend = ()=>{\r\n            let friendName = this.nickNameRef.value.trim()\r\n            friendName!=='' && sdk.conn.subscribe({\r\n                to: this.nickNameRef.value.trim(),\r\n                message: '你好，我是张治国，交个朋友呗！'\r\n            })\r\n            dialog.close()\r\n        }\r\n    }\r\n    // 组件卸载前，把事件监听去掉\r\n    componentWillUnmount(){\r\n        eventEmitter.removeListener('presence', this.handlePresence)\r\n    }\r\n\r\n    render(){\r\n        let {chatId, allFriend} = this.props\r\n        return (\r\n            <div className=\"sessionList\">\r\n                <div className='addFriendBtn'>\r\n                    <i className=\"iconfont icon-hao\" onClick={this.showAddFriend}></i>\r\n                </div>\r\n                <ul>{\r\n                    allFriend.length===0 ? null : allFriend.map((item)=>{\r\n                        let isSelected = chatId === item.name ? true : false\r\n                        return (\r\n                            <li key={item.name} className={isSelected ? 'list listActive' : 'list'}>\r\n                                <SessionItem  friend={item}/>\r\n                            </li>\r\n                        )\r\n                    })\r\n                }</ul>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\n@connect(\r\n    ()=>{return {}},\r\n    {currentSessionActon}\r\n)\r\nclass SessionItem extends Component{\r\n    componentWillMount(){\r\n        // 修改store状态树中当前聊天的好友\r\n        this.itemClick = ()=>{\r\n            let {friend} = this.props\r\n            this.props.currentSessionActon(friend)     //已经改造，connect函数自动dispatch\r\n        }  \r\n    }\r\n    shouldComponentUpdate(nextProps, nextState){\r\n        // 问题点：以前好友A发一条消息，渲染四次，因为好友列表中有四个好友\r\n        // 改善：好友A发一条消息，只要好友A渲染（渲染目的是添加消息预览）,其他好友不渲染\r\n        // 当上一个好友对象和新的好友对象不同时，此函数返回true，进行渲染\r\n        // 为什么不同？因为如果是好友A发的消息，就会在A对象上添加newMsg属性，故而不同\r\n        // 附加：如果上一次点击的和这次点击的不同，返回true进行渲染，渲染两次（一个是去掉active, 一个是加上active） \r\n        return !shallowequal(this.props.friend, nextProps.friend) || !shallowequal(this.props.isSelected, nextProps.isSelected)\r\n    }\r\n    render(){      \r\n        let {friend} = this.props    \r\n        let url = {\r\n            pathname: `/chat/single/${friend.name}`,\r\n            state: {'chatType': 'single', 'friendName': `${friend.name}`}\r\n        }\r\n        // 点击Link链接，渲染chat页面（不重载），读取location信息，传给sessionList子组件\r\n        return (\r\n            <div className='sessionItem'>\r\n                <Link to={url} onClick={this.itemClick} >  \r\n                    <div className=\"sm_lf\">\r\n                        <img src={require('../../../img/photo_other.jpg')} alt=\"\"/>\r\n                    </div>\r\n                    <div className=\"sm_rt\">\r\n                        <h3>{friend.name}</h3>\r\n                        <p>{friend.newMsg ? friend.newMsg.value : ''}</p>\r\n                    </div>\r\n                </Link>\r\n            </div>\r\n        )\r\n    }\r\n}\r\nexport default SessionList\r\n\r\n\r\n/*************** 此模块是SessionItem组件 *******************/\r\n/* 输入： */\r\n// props属性对象：friend（好友信息）\r\n\r\n/* 输出： */\r\n// 好友列表中每一个好友\r\n\r\n/* Link链接： */\r\n// <Link to={ {pathname:xx, state:yy} }>点击跳转</Link> \r\n// xx是跳转地址，yy是聊天类型和好友名字\r\n\r\n/* 绑定事件： */\r\n// 点击好友的事件处理函数，用当前新的好友 修改 store中保存的旧的会话好友\r\n","import React, { Component } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport SlideBar from './sliderBar'\r\nimport BubblePanel from './bubblePanel'\r\nimport SessionList from './sessionList'\r\nimport {init} from '../../data/actions/message'\r\nimport './index.css'\r\n\r\n@connect(\r\n    ()=>({}),\r\n    {init}\r\n)\r\nclass Chat extends Component{\r\n    componentWillMount(){\r\n        this.props.init()\r\n    }\r\n    render(){    \r\n        // 点击Link链接，渲染chat页面（不重载），读取location信息，传给sessionList子组件，现在换了一种方式，此处没用上\r\n        let {chatType, friendName} = Object.assign({}, this.props.location.state)\r\n        return (\r\n            <div className=\"ctn-chat\">\r\n                <SlideBar />\r\n                <SessionList chatType={chatType} chatId={friendName}/>\r\n                <BubblePanel chatType={chatType} chatId={friendName} />\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Chat","import React, { Component } from 'react'\r\nimport { Provider } from 'react-redux'\r\nimport store from './data/store'\r\nimport history from './history/history'\r\nimport conn from './sdk/init'\r\nimport {getToken} from './utils/token'\r\nimport Login from './component/sign/Login'\r\nimport Signup from './component/sign/Signup'\r\nimport Chat from './component/chat/index'\r\nimport {HashRouter as Router, Route} from 'react-router-dom' \r\nimport './App.css'\r\n\r\nwindow.sdk = { conn: conn }\r\n\r\nclass Home extends Component{\r\n    render(){\r\n        let token = getToken()        \r\n        return (\r\n            <div>\r\n                {!token && \r\n                    history.location.pathname!=='/login' ? history.push('/login') : null}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default class App extends Component{\r\n    render(){\r\n        return (\r\n            <Provider store={store}>\r\n                <Router>\r\n                    <div className='app_Wrapper'>\r\n                        <Route path=\"/\" component={Home} />\r\n                        <Route path=\"/signUp\" component={Signup} />\r\n                        <Route path=\"/login\" component={Login} />\r\n                        <Route path=\"/chat\" component={Chat} /> \r\n                        {/* <Route path=\"/chat/:chatType/:chatId\" component={Chat} />  */}\r\n                    </div>\r\n                </Router>\r\n            </Provider>\r\n        )\r\n    }\r\n}","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (!isLocalhost) {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      } else {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport registerServiceWorker from './registerServiceWorker'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\nregisterServiceWorker();\n"],"sourceRoot":""}